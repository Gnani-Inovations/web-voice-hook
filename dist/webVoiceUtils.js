export function floatTo16BitPCM(t){const e=new Int16Array(t.length);for(let o=0;o<t.length;o++){const r=Math.max(-1,Math.min(1,t[o]));e[o]=r<0?32768*r:32767*r}return e}export const base64ToPCM16Data=t=>{const e=atob(t),o=new ArrayBuffer(e.length),r=new Uint8Array(o);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return new Int16Array(o)};export function linearToMuLaw(t){const e=new Uint8Array(t.length);for(let o=0;o<t.length;o++){let r=t[o],n=r>>8&128;n&&(r=-r),r>32635&&(r=32635),r+=132;let a,s=7;for(;s>0&&!(16384&r);s--)r<<=1;a=r>>9&15;let i=~(n|s<<4|a);e[o]=255&i}return e}export const getBase64Audio=t=>{const e=linearToMuLaw(floatTo16BitPCM(t));return btoa(String.fromCharCode.apply(null,Array.from(e)))};export const resetAudioInput=t=>{t?.getTracks().forEach((t=>t.stop()))};export const createWavHeader=t=>{const e=new ArrayBuffer(44),o=new DataView(e);return o.setUint8(0,"R".charCodeAt(0)),o.setUint8(1,"I".charCodeAt(0)),o.setUint8(2,"F".charCodeAt(0)),o.setUint8(3,"F".charCodeAt(0)),o.setUint32(4,t+36,!0),o.setUint8(8,"W".charCodeAt(0)),o.setUint8(9,"A".charCodeAt(0)),o.setUint8(10,"V".charCodeAt(0)),o.setUint8(11,"E".charCodeAt(0)),o.setUint8(12,"f".charCodeAt(0)),o.setUint8(13,"m".charCodeAt(0)),o.setUint8(14,"t".charCodeAt(0)),o.setUint8(15," ".charCodeAt(0)),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,CHANNELS,!0),o.setUint32(24,SAMPLE_RATE,!0),o.setUint32(28,SAMPLE_RATE*CHANNELS*(BITS_PER_SAMPLE/8),!0),o.setUint16(32,CHANNELS*(BITS_PER_SAMPLE/8),!0),o.setUint16(34,BITS_PER_SAMPLE,!0),o.setUint8(36,"d".charCodeAt(0)),o.setUint8(37,"a".charCodeAt(0)),o.setUint8(38,"t".charCodeAt(0)),o.setUint8(39,"a".charCodeAt(0)),o.setUint32(40,t,!0),e};export const getAudioWorkletModule=()=>URL.createObjectURL(new Blob(["\n  class AudioProcessor extends AudioWorkletProcessor {\n    process(inputs, outputs) {\n      const input = inputs[0][0];\n      if (input) {\n        this.port.postMessage(input);\n      }\n      return true;\n    }\n  }\n  registerProcessor('audio-processor', AudioProcessor);\n"],{type:"text/javascript"}));export const convertPCMDataToFloat32=t=>{const e=new Float32Array(t.length);for(let o=0;o<t.length;o++)e[o]=t[o]/(t[o]<0?32768:32767);return e};export const convertPCMDataWithWavHeaderToFloat32=t=>{const e=createWavHeader(t.byteLength),o=new Int16Array(e),r=new Int16Array(o.length+t.length);r.set(o),r.set(t,o.length);return convertPCMDataToFloat32(r)};export const SAMPLE_RATE=44100;export const CHANNELS=1;export const BITS_PER_SAMPLE=16;export const WORKLET_NODE_OPTIONS={processorOptions:{sampleRate:SAMPLE_RATE,channelCount:CHANNELS},numberOfInputs:1,numberOfOutputs:1,channelCount:CHANNELS};export const resampleAudio=(t,e,o)=>{const r=o/e,n=Math.floor(t.length*r),a=new Float32Array(n);for(let e=0;e<n;e++){const o=e/r,n=Math.floor(o),s=o-n;n>=t.length-1?a[e]=t[t.length-1]:a[e]=t[n]*(1-s)+t[n+1]*s}return a};export const getVisualizerOptions=t=>({source:t,smoothing:.8,lineWidth:16,maxFreq:1300,mode:2,width:400,height:200,volume:0,showScaleX:!1,showPeaks:!1,alphaBars:!1,ansiBands:!1,barSpace:.75,bgAlpha:1,channelLayout:"single",fadePeaks:!1,fillAlpha:1,frequencyScale:"log",gradient:"prism",gravity:8,ledBars:!1,linearAmplitude:!0,linearBoost:1.6,loRes:!1,lumiBars:!1,maxDecibels:-35,maxFPS:0,minDecibels:-85,minFreq:300,mirror:0,noteLabels:!1,outlineBars:!0,overlay:!0,peakFadeTime:750,peakHoldTime:500,peakLine:!1,radial:!1,radialInvert:!1,radius:.3,reflexAlpha:1,reflexBright:1,reflexFit:!0,reflexRatio:.5,roundBars:!0,showBgColor:!1,showFPS:!1,showScaleY:!1,spinSpeed:1,splitGradient:!1,trueLeds:!1,useCanvas:!0,weightingFilter:"A"});export const applyCustomColor=(t,e)=>{if(t&&t.canvas){const o=t.canvas,r=o.getContext("2d");if(!r)return;const n=r.drawImage;r.drawImage=function(t,...a){n.apply(r,[t,...a]),r.globalCompositeOperation="source-atop",r.fillStyle=e??"#9E77ED",r.fillRect(0,0,o.width,o.height),r.globalCompositeOperation="source-over"}}};
//# sourceMappingURL=webVoiceUtils.js.map